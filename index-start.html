<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Expense Tracker App</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 0; }
    .container { max-width: 400px; margin: 40px auto; background: #fff; padding: 24px; border-radius: 8px; box-shadow: 0 2px 8px #ccc; }
    h2 { text-align: center; }
    form { margin-bottom: 16px; }
    input[type="text"], input[type="number"], input[type="password"], input[type="date"] {
      width: 100%; padding: 8px; margin: 6px 0 12px 0; border: 1px solid #ccc; border-radius: 4px;
    }
    button { width: 100%; padding: 10px; background: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background: #0056b3; }
    ul { list-style: none; padding: 0; }
    li { background: #f9f9f9; margin: 6px 0; padding: 8px; border-radius: 4px; display: flex; justify-content: space-between; }
    .total { font-weight: bold; margin-top: 12px; }
    .logout { background: #dc3545; margin-top: 12px; }
  </style>
</head>
<body>
  <div class="container" id="login-container">
    <h2>Login</h2>
    <form id="login-form">
      <input type="text" id="username" placeholder="Username" required />
      <input type="password" id="password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>
    <div id="login-error" style="color: red; display: none;">Invalid credentials.</div>
  </div>

  <div class="container" id="app-container" style="display: none;">
    <h2>Expense Tracker</h2>
    <form id="expense-form">
      <input type="text" id="desc" placeholder="Expense Description" required />
      <input type="number" id="amount" placeholder="Amount" min="0.01" step="0.01" required />
      <input type="date" id="expense-date" required />
      <button type="submit">Add Expense</button>
    </form>
    <ul id="expense-list"></ul>
    <div class="total">Total: ₹<span id="total">0.00</span></div>
    <button class="logout" id="logout-btn">Logout</button>
  </div>

  <script>
    // Simple demo credentials
    const DEMO_USER = { username: "user", password: "pass" };

    // Login logic
    const loginForm = document.getElementById('login-form');
    const loginContainer = document.getElementById('login-container');
    const appContainer = document.getElementById('app-container');
    const loginError = document.getElementById('login-error');

    loginForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      if (username === DEMO_USER.username && password === DEMO_USER.password) {
        loginContainer.style.display = 'none';
        appContainer.style.display = 'block';
        loginError.style.display = 'none';
        loadExpenses();
      } else {
        loginError.style.display = 'block';
      }
    });

    // Logout logic
    document.getElementById('logout-btn').onclick = function() {
      appContainer.style.display = 'none';
      loginContainer.style.display = 'block';
      loginForm.reset();
    };

    // Expense tracker logic
    const expenseForm = document.getElementById('expense-form');
    const expenseList = document.getElementById('expense-list');
    const totalSpan = document.getElementById('total');

    function setTodayDate() {
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('expense-date').value = today;
    }

    function loadExpenses() {
      const expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
      renderExpenses(expenses);
      setTodayDate();
    }

    function formatDate(dateString) {
      if (!dateString) return '';
      const expenseDate = new Date(dateString);
      const today = new Date();
      const yesterday = new Date(today);
      yesterday.setDate(yesterday.getDate() - 1);
      
      if (expenseDate.toDateString() === today.toDateString()) {
        return 'Today';
      } else if (expenseDate.toDateString() === yesterday.toDateString()) {
        return 'Yesterday';
      } else {
        return expenseDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
      }
    }

    function renderExpenses(expenses) {
      expenseList.innerHTML = '';
      let total = 0;
      expenses.forEach((exp, idx) => {
        total += parseFloat(exp.amount);
        const dateDisplay = exp.date ? ` (${formatDate(exp.date)})` : '';
        const li = document.createElement('li');
        li.innerHTML = `
          <span>${exp.desc} - ₹${parseFloat(exp.amount).toFixed(2)}${dateDisplay}</span>
          <button onclick="removeExpense(${idx})" style="background:#dc3545;color:#fff;border:none;padding:4px 8px;border-radius:3px;cursor:pointer;">Delete</button>
        `;
        expenseList.appendChild(li);
      });
      totalSpan.textContent = total.toFixed(2);
    }

    expenseForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const desc = document.getElementById('desc').value;
      const amount = document.getElementById('amount').value;
      const date = document.getElementById('expense-date').value;
      let expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
      expenses.push({ desc, amount, date });
      localStorage.setItem('expenses', JSON.stringify(expenses));
      renderExpenses(expenses);
      expenseForm.reset();
      setTodayDate();
    });

    // Remove expense (global for inline onclick)
    window.removeExpense = function(idx) {
      let expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
      expenses.splice(idx, 1);
      localStorage.setItem('expenses', JSON.stringify(expenses));
      renderExpenses(expenses);
    };

    // Optional: Auto-load if already logged in (for demo, always show login)
    // loadExpenses();
  </script>
</body>
</html>
